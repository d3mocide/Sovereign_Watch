syntax = "proto3";

package tak.proto;

/* 
 * Simplified TAK Protocol V1 for Sovereign Watch 
 * Based on basic CoT (Cursor on Target) Schema 
 */

message TakMessage {
  CotEvent cotEvent = 1;
}

message CotEvent {
  // Required: Unique Identifier
  string uid = 1;

  // Required: Hierarchical Type (e.g., "a-f-A-M-F")
  string type = 2;

  // Required: Time stamps (ISO 8601 strings or epoch micros)
  // For this simplified version we use epoch millis for speed
  uint64 start = 3;
  uint64 stale = 4;
  uint64 time = 5;

  // Recommended: How
  string how = 6; // e.g., "m-g" (machine-gps)

  // Point Data
  double lat = 7;
  double lon = 8;
  double hae = 9; // Height Above Ellipsoid (Meters)
  double ce = 10; // Circular Error
  double le = 11; // Linear Error

  // Detail Data (Flexible)
  Detail detail = 12;
}

message Detail {
  Contact contact = 1;
  Track track = 2;
  Group group = 3;
  Status status = 4;
  PrecisionLocation precisionLocation = 5;
  Classification classification = 6;
  VesselClassification vesselClassification = 7;
  // XML fallback for unmapped fields
  string xmlDetail = 100; 
}

message Contact {
  string callsign = 1;
  string endpoint = 2;
}

message Track {
  double course = 1; // Degrees
  double speed = 2;  // Meters/second
  double slope = 3;  // Degrees
  double vspeed = 4; // Feet/minute (standard aviation)
}

message Group {
  string name = 1;
  string role = 2;
}

message Status {
  uint32 battery = 1;
  bool readiness = 2;
}

message PrecisionLocation {
  string geopointsrc = 1;
  string altsrc = 2;
}

message Classification {
  string affiliation = 1;
  string platform = 2;
  string size_class = 3;
  string icao_type = 4;
  string category = 5;
  uint32 db_flags = 6;
  string operator = 7;
  string registration = 8;
  string description = 9;
  string squawk = 10;
  string emergency = 11;
}

message VesselClassification {
  string category = 1;
  uint32 ship_type = 2;
  uint32 nav_status = 3;
  bool hazardous = 4;
  string station_type = 5;
  uint32 flag_mid = 6;
  uint32 imo = 7;
  string callsign = 8;
  string destination = 9;
  float draught = 10;
  float length = 11;
  float beam = 12;
}
