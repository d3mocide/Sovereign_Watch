# Sovereign Watch: Comprehensive Implementation Blueprint and Technical Roadmap for Distributed Multi-INT Fusion

## 1. Executive Summary

### 1.1 Strategic Vision: The Paradigm of Active Sovereignty

The contemporary global intelligence environment operates under a paradoxical condition: never before has so much data been generated by the digital exhaust of human activity, yet never has the ability to independently verify this data been so constrained by commercial intermediation.

Sovereign Watch defines a break from this dependency. It proposes a transition from a "Consumption Model" to an "Active Collection Model." By deploying a self-hosted, distributed fusion center, d3FRAG Networks seeks to reclaim data sovereignty. This platform is not merely a visualization tool; it is a "System of Systems" engineered to ingest raw, unfiltered telemetry from the "Fediverse of Things" (decentralized sensor networks), normalize disparate data formats into a military-standard schema (Cursor on Target / TAK Protocol), and apply hybrid artificial intelligence to extract semantic meaning from the chaos of raw signals.

### 1.2 The Strategic Pivot: Research-Driven Architecture

Following a rigorous technical audit (See `docs/research/`), the architecture has pivoted to address critical constraints in browser rendering and data volume:

1.  **Hybrid Rendering Engine**: Shifted from "Pure WebGPU" to **WebGL2 Interleaved Rendering** to solve depth occlusion (Z-buffering) issues with 3D terrain. WebGPU is retained solely as a headless compute engine for physics simulation ("Invisible WebGPU").
2.  **Protocol Efficiency**: Standardization on **TAK Protocol V1 (Protobuf)** instead of XML/JSON. This reduces bandwidth by ~83% and eliminates main-thread parsing bottlenecks for high-volume tracks (100k+ entities).
3.  **Pulse Ingestion**: Implementation of "Pulse" pipelines (Cron-based) for high-latency data sources like Space-Track (Orbital) and NOAA (Space Weather), decoupling them from the real-time streaming core.

### 1.3 Architectural Directive

This report outlines a five-layer unbundled architecture designed to meet these challenges using commodity hardware and open-source software.

- **Ingestion**: Redpanda Connect (Benthos) for stateless stream processing and "Pulse" batching.
- **Streaming**: Redpanda (C++ Kafka) for low-latency, high-throughput event buffering.
- **Persistence**: TimescaleDB (PostgreSQL) with pgvectorscale for hybrid time-series and vector storage.
- **Cognition**: A Hybrid AI orchestration layer using LiteLLM to route sensitive tasks to local Edge AI (Jetson/Llama 3) and cloud models.
- **Visualization**: A React 18+ frontend leveraging Deck.gl (WebGL2) and Mapbox GL JS for "Digital Twin" fidelity.

## 2. Infrastructure and DevOps Architecture

(See original roadmap for network segmentation details. No major changes.)

## 3. The Ingestion Layer: Active Collection & Normalization

The validity of any intelligence product is determined by the quality of its source material.

### 3.1 The Universal Adapter: Redpanda Connect (Benthos)

We utilize Redpanda Connect (formerly Benthos) as the ingestion engine. It handles both streaming (WebSocket) and batch (HTTP Polling) sources.

### 3.2 Data Standardization: TAK Protocol (Protobuf)

The platform standardizes on **TAK Protocol Version 1**.

- **Format**: Protocol Buffers (binary).
- **Header**: Magic Bytes `0xbf 0x01 0xbf` prepended to every message for interoperability with ATAK/WinTAK clients.
- **Efficiency**: Enables zero-copy deserialization in the browser via Web Workers.

### 3.3 Aviation Intelligence: The Airplanes.live Pipeline

- **Source**: Airplanes.live (Unfiltered, Free).
- **Protocol**: HTTP Polling (1Hz).
- **Mapping**: JSON -> TAK Protobuf (`a-f-A`).
- **Logic**: Bitwise decoding of `dbFlags` to identify Military and LADD traffic.

### 3.4 Maritime Intelligence: The AISStream Pipeline

- **Source**: aisstream.io (WebSocket).
- **Protocol**: Secure WebSocket.
- **Mapping**: NMEA/JSON -> TAK Protobuf (`a-f-S`).

### 3.5 Orbital Intelligence: The Space-Track Pulse

- **Source**: Space-Track.org.
- **Protocol**: HTTP Pulse (6-hour interval).
- **Logic**: Stateful authentication (POST credentials -> Capture Cookie -> GET Data).
- **Output**: TAK Protobuf (`a-s-K` for Keplerian elements).

### 3.6 SIGINT & Spectrum: Jamming & SatNOGS

- **Jamming**: Aggregation of ADS-B Integrity indicators (NIC/NACp) by H3 Hexagon. Output: TAK Interference Object (`y-g-i`).
- **Spectrum**: SatNOGS waterfall verification (`status=good`). Output: TAK Observation (`r-s-g`).

## 4. The Persistence Layer: Time, Space, and Semantics

(Retained: TimescaleDB Hypertables + PostGIS + pgvectorscale).

## 5. The Cognitive Layer: Hybrid AI Orchestration

(Retained: LiteLLM Gateway, Local Whispers, Ollama).

## 6. The Presentation Layer: The "Glass"

The frontend is the "Single Pane of Glass" for the analyst.

### 6.1 Hybrid Rendering Architecture

- **Visual Layer (WebGL2)**: `MapboxOverlay` with `interleaved: true`. Renders tactical icons and paths _inside_ the Mapbox GL JS context to ensure proper occlusion by 3D terrain.
- **Compute Layer (WebGPU)**: "Invisible" Headless WebGPU Worker. Calculates positions for high-volume entities (e.g., "Agent Swarm" particles) and SGP4 orbital propagation. Transfers data to Main Thread via Zero-Copy `Float32Array`.

### 6.2 Tactical UI Design System ("Sovereign Glass")

- **Aesthetic**: Neon Noir / FUI (Fictional User Interface).
- **Architecture**: **Chevron-First**. Eliminated legacy dot markers in favor of unified, kite-style directional chevrons.
- **HUD Components**: High-fidelity modular shell featuring a global **TopBar** with synchronized UTC tactical clock and live state metadata.
- **Optics**: High-contrast vector pointers with integrated pulsing halos and reactive situational alert coloring.
- **Aesthetic Refinement**: Prioritized monitor-grade clarity using Micro-Noise grain and grid patterns. Removed legacy scanlines for professional situational awareness.
- **Interaction**: Unified hover/click logic directly on vector markers for seamless target locking and trail inspection.

## 7. Master Task List for AI Agents

| ID             | Task Name      | Component | Description                                                              |
| :------------- | :------------- | :-------- | :----------------------------------------------------------------------- |
| **Infra-01**   | Docker Env     | DevOps    | **DONE**. 3-network isolation, Redpanda, TimescaleDB.                    |
| **DB-01**      | Schema         | Database  | **DONE**. Hypertables and Vector Index enabled.                          |
| **FE-01**      | Hybrid Map     | Frontend  | **DONE (Code Refactored)**. Needs Build. Implements `interleaved: true`. |
| **Ingest-01**  | Aviation       | Data Eng  | **Updates Required**: Migrate output from CoT XML to **TAK Protobuf**.   |
| **Ingest-02**  | Maritime       | Data Eng  | **Updates Required**: Migrate output from CoT XML to **TAK Protobuf**.   |
| **Ingest-03**  | Orbital        | Data Eng  | **NEW**. Create Pulse pipeline for Space-Track.                          |
| **Ingest-04**  | SIGINT         | Data Eng  | **NEW**. Create Jamming Analysis pipeline (H3 Aggregation).              |
| **FE-04**      | WebGPU Physics | Frontend  | **NEW**. Create Headless WebGPU worker for Boids/SGP4.                   |
| **FE-05**      | TAK Decoder    | Frontend  | **NEW**. Create Client-side Protobuf worker with Magic Byte handling.    |
| **Backend-01** | Fusion API     | Backend   | **DONE**. FastAPI skeleton ready.                                        |

---

_Verified against "Aircraft and Marine Tracking APIs" report and "Technical Feasibility Study"._
